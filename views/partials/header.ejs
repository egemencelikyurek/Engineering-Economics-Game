<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Proje</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/fontawesome5-overrides.min.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/Login-Form-Clean.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/Navigation-with-Button.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/Registration-Form-with-Photo.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/styles.css">
    <link rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
</head>

<body>
    <% if(!currentUser){ %>
    <nav class="navbar navbar-dark navbar-expand-md bg-dark navigation-clean-button" style="padding: 8px;">
        <div class="container">
            <a href="/" style="padding-right: 0px;width: 36px;font-size: 16px;margin-right: 14px;">
                <i class="fa fa-home" style="font-size: 36px;margin-right: 0px;color: #f1f7fc;"></i>
            </a>
            <a class="navbar-brand" href="#" style="font-size: 22px;margin-right: 0px;width: auto;">GamEco</a>
            <button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <span class="ml-auto navbar-text actions" style="margin-top: 2px;">
                    <a class="login" href="/login" style="font-size: 19px;">Login</a>
                    <a class="btn btn-primary action-button" role="button" href="/register"
                        style="font-size: 18px;">Sign Up</a>
                </span>
            </div>
        </div>
    </nav>
    <% if(error && error.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <%= error %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% if(success && success.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <%= success %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% }else{ %>
    <% if(currentUser.usertype == "Instructor"){ %>
    <nav class="navbar navbar-dark navbar-expand-md bg-dark navigation-clean-button" style="padding: 8px;">
        <div class="container"><a href="/main"
                style="padding-right: 0px;width: 36px;font-size: 16px;margin-right: 14px;"><i class="fa fa-home"
                    style="font-size: 36px;margin-right: 0px;color: white;"></i></a><a class="navbar-brand" href="#"
                style="font-size: 22px;margin-right: 0px;width: auto;">GamEco</a>
            <button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1"><span class="sr-only">Toggle
                    navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="nav navbar-nav mr-auto">
                    <li class="nav-item" role="presentation"><a
                            class="nav-link d-lg-flex justify-content-lg-center align-items-lg-center"
                            style="font-weight: normal;font-style: normal;font-size: 19px;width: auto;"
                            href="/yourclasses">Your Classes</a></li>
                </ul>
                <span class="navbar-text actions" style="margin: 2px 0 0 15px;"> <a class="btn btn-light action-button"
                        role="button" href="/logout"
                        style="font-size: 18px;background-color: rgb(239,62,51);">Logout</a></span>
            </div>
        </div>
    </nav>
    <% if(error && error.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <%= error %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% if(success && success.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <%= success %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% }else{ %>
    <nav class="navbar navbar-dark navbar-expand-md bg-dark navigation-clean-button" style="padding: 8px;">
        <div class="container"><a href="/main"
                style="padding-right: 0px;width: 36px;font-size: 16px;margin-right: 14px;"><i class="fa fa-home"
                    style="font-size: 36px;margin-right: 0px;color: white;"></i></a><a class="navbar-brand" href="#"
                style="font-size: 22px;margin-right: 0px;width: auto;">GamEco</a>
            <button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1"><span class="sr-only">Toggle
                    navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="nav navbar-nav mr-auto">
                    <li class="nav-item" role="presentation"><a
                            class="nav-link d-lg-flex justify-content-lg-center align-items-lg-center"
                            style="font-weight: normal;font-style: normal;font-size: 19px;width: auto;"
                            href="/leaderboard"><i class="fas fa-crown"
                                style="font-size: 21px;margin-right: 5px;color: rgb(255,249,115);"></i>Leaderboard</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="balancedropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 20px;">
                            <i class="fas fa-folder-open"
                                style="font-size: 24px;padding-right: 0px;color:rgb(39, 236, 227);width: auto;margin-right: 10px;margin-left: -9px;"></i>My
                            Portfolio
                        </a>
                        <div class="dropdown-menu" aria-labelledby="balancedropdown">
                            <a class="dropdown-item" href="/portfolio">My Portfolio</a>
                            <a class="dropdown-item" href="/balance">Balance</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 20px;">
                            <i class="fas fa-hand-holding-usd"
                                style="font-size: 24px;padding-right: 0px;color: rgb(138,240,130);width: auto;margin-right: 10px;margin-left: -9px;"></i>Bank
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="/bank">Bank Account</a>
                            <a class="dropdown-item" href="/loan">Take Loan</a>
                            <a class="dropdown-item" href="/yourloans">Your Payments</a>
                        </div>
                    </li>
                </ul>
                <button type="button" id="inttt" data-toggle="modal" data-target="#tokenModal">
                    <span style="margin-right: 20px;">
                        <img width="20px" height="20px" src="/images/token2.png" alt="Tokennn"> <%= (currentUser.token) %>
                    </span>
                </button>
                <div class="modal fade" id="tokenModal" tabindex="-1" role="dialog"
                    aria-labelledby="exx" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 style="color: black;" class="modal-title" id="exx">Use Token</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <form action="/usetoken?_method=PUT" method="POST">
                            <div class="modal-body">
                                <div style="color: black;">
                                    <% if(currentUser.token == 0){ %>
                                        <p>You don'have any token. Be active in class :)</p>
                                    <% }else{ %>
                                        <p>You have <%= currentUser.token %> token. You can choose one of the options.</p>
                                        
                                            <div class="form-control">
                                                <input type="radio" name="choice" value="1"> Take 20.000 loan without interest 
                                            </div>
                                            <div class="form-control">
                                                <input type="radio" name="choice" value="2"> Get 50% discount on costs once
                                            </div>
                                            <div class="form-control">
                                                <input type="radio" name="choice" value="3"> Get 5.000 cash
                                            </div>
                                    <% } %>
                                </div>                                
                            </div>
                            <div class="modal-footer">
                                <% if(currentUser.token > 0){ %>
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                <% } %>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                
                            </div>
                        </form>
                        </div>
                    </div>
                </div>
                </button>
                <button type="button" id="inttt" data-toggle="modal" data-target="#exampleModal">
                    <span style="margin-right: 20px;"><i
                            class="fas fa-percentage"></i> <%= (currentClass.interestRate*100).toFixed(2) %></span>
                </button>

                <!-- Modal -->
                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 style="color: black;" class="modal-title" id="exampleModalLabel">Forecast for next change</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div style="color: black;">
                                    <span>
                                        <i class="fas fa-arrow-up" style="color: green;"></i>
                                        <span>%<%= (currentClass.trend*100).toFixed(1) %></span>
                                    </span>
                                    <span>
                                        <i class="fas fa-arrow-down" style="color: red;"></i>
                                        <span>%<%= ((1-currentClass.trend)*100).toFixed(1) %></span>
                                    </span>
                                    <h6 style="margin-top: 15px;">Next change: <%= (moment(currentClass.changeDate).add(3, "h")).diff(moment(), "hours") %> Hours <%= (moment(currentClass.changeDate).add(3, "h")).diff(moment(),"minutes")%60 %> Minute</h6>
                                </div>                                
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <span> <i style="color:gold;" class="fas fa-coins"></i> <%= currentUser.money.toFixed(0) %> PB</span>
                <span class="navbar-text actions" style="margin: 2px 0 0 15px;"> <a class="btn btn-light action-button"
                        role="button" href="/logout"
                        style="font-size: 18px;background-color: rgb(239,62,51);">Logout</a></span>
            </div>
        </div>
    </nav>
    <% if(error && error.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <%= error %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% if(success && success.length>0){ %>
    <div class="container" style="margin-top: 10px;">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <%= success %>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
    <% } %>
    <% } %>
    <% } %>